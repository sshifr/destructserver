# DestructServer

–°–∏—Å—Ç–µ–º–∞ –∞–Ω–∞–ª–∏–∑–∞ –º–µ–¥–∏–∞-–∫–æ–Ω—Ç–µ–Ω—Ç–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º YOLO, DeepFace –∏ –∞—É–¥–∏–æ-–∞–Ω–∞–ª–∏–∑–∞ –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –¥–µ—Å—Ç—Ä—É–∫—Ç–∏–≤–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞.

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

- **Docker** –∏ **Docker Compose** —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –Ω–∞ –≤–∞—à–µ–π —Å–∏—Å—Ç–µ–º–µ
- **Linux** (–¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ñ–∏–∑–∏—á–µ—Å–∫–∏–º–∏ –∫–∞–º–µ—Ä–∞–º–∏ —á–µ—Ä–µ–∑ `/dev/video0`)
- –ú–∏–Ω–∏–º—É–º **8GB RAM** —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –º–æ–¥–µ–ª—è–º–∏ –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è

### –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞

1. **–ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π** (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ git):

   ```bash
   git clone <repository-url>
   cd destructserver
   ```

2. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã**:

   ```bash
   docker compose up --build
   ```

   –≠—Ç–∞ –∫–æ–º–∞–Ω–¥–∞:
   - –°–æ–±–µ—Ä—ë—Ç –æ–±—Ä–∞–∑—ã –¥–ª—è frontend –∏ backend
   - –£—Å—Ç–∞–Ω–æ–≤–∏—Ç –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
   - –ó–∞–ø—É—Å—Ç–∏—Ç –≤—Å–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã

3. **–û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ**:
   ```
   http://localhost
   ```

### –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞

**–û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Å–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã**:

```bash
docker compose down
```

**–û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏ —É–¥–∞–ª–∏—Ç—å volumes** (–æ—á–∏—Å—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö):

```bash
docker compose down -v
```

## üìã –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–∞–º–∏

### –ó–∞–ø—É—Å–∫ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤

```bash
# –¢–æ–ª—å–∫–æ frontend
docker compose up frontend

# –¢–æ–ª—å–∫–æ backend
docker compose up backend

# –¢–æ–ª—å–∫–æ nginx
docker compose up nginx
```

### –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–æ–≤

```bash
# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã
docker compose restart

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Å–µ—Ä–≤–∏—Å
docker compose restart backend
docker compose restart frontend
docker compose restart nginx
```

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤

```bash
# –õ–æ–≥–∏ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
docker compose logs -f

# –õ–æ–≥–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞
docker compose logs -f backend
docker compose logs -f frontend
docker compose logs -f nginx

# –ü–æ—Å–ª–µ–¥–Ω–∏–µ 100 —Å—Ç—Ä–æ–∫ –ª–æ–≥–æ–≤
docker compose logs --tail=100 backend
```

### –ü–µ—Ä–µ—Å–±–æ—Ä–∫–∞ –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π

```bash
# –ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å –≤—Å–µ –æ–±—Ä–∞–∑—ã
docker compose up --build

# –ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Å–µ—Ä–≤–∏—Å
docker compose up --build backend
docker compose up --build frontend
```

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
destructserver/
‚îú‚îÄ‚îÄ destruct-frontend/     # React –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
‚îÇ   ‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ public/
‚îÇ   ‚îî‚îÄ‚îÄ Dockerfile
‚îú‚îÄ‚îÄ destruct-server/        # Node.js + Python backend
‚îÇ   ‚îú‚îÄ‚îÄ yolo11/            # YOLO –º–æ–¥–µ–ª–∏ –∏ —Å–∫—Ä–∏–ø—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ audio/             # –ê—É–¥–∏–æ-–∞–Ω–∞–ª–∏–∑
‚îÇ   ‚îú‚îÄ‚îÄ server.js          # Express —Å–µ—Ä–≤–µ—Ä
‚îÇ   ‚îî‚îÄ‚îÄ Dockerfile
‚îú‚îÄ‚îÄ nginx.conf             # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Nginx
‚îú‚îÄ‚îÄ docker-compose.yml     # Docker Compose –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îî‚îÄ‚îÄ README.md             # –≠—Ç–æ—Ç —Ñ–∞–π–ª
```

## üåê –î–æ—Å—Ç—É–ø–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –ø—Ä–æ–µ–∫—Ç –¥–æ—Å—Ç—É–ø–µ–Ω —á–µ—Ä–µ–∑ Nginx –Ω–∞ –ø–æ—Ä—Ç—É **80**:

- **Frontend**: `http://localhost`
- **Backend API**: `http://localhost/api/...`
- **WebSocket (–∫–∞–º–µ—Ä–∞)**: `ws://localhost/api/ws/camera`
- **–°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã**:
  - `http://localhost/uploads/...` - –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
  - `http://localhost/result/...` - —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–Ω–∞–ª–∏–∑–∞

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ü–æ—Ä—Ç—ã

- **80** - Nginx (–æ—Å–Ω–æ–≤–Ω–æ–π –¥–æ—Å—Ç—É–ø)
- **3000** - React dev server (–ø—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø, –Ω–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
- **3001** - Backend API (–ø—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø, –Ω–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

**Frontend** (`destruct-frontend`):

- `CHOKIDAR_USEPOLLING=true` - –¥–ª—è hot reload –≤ Docker
- `HOST=0.0.0.0` - —Å–ª—É—à–∞—Ç—å –Ω–∞ –≤—Å–µ—Ö –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞—Ö
- `REACT_APP_API_URL=http://localhost/api` - URL API

**Backend** (`destruct-server`):

- `PORT=3001` - –ø–æ—Ä—Ç —Å–µ—Ä–≤–µ—Ä–∞
- `HOST=0.0.0.0` - —Å–ª—É—à–∞—Ç—å –Ω–∞ –≤—Å–µ—Ö –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞—Ö
- `NODE_ENV=development` - —Ä–µ–∂–∏–º —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

### –î–æ—Å—Ç—É–ø –∫ —Ñ–∏–∑–∏—á–µ—Å–∫–æ–π –∫–∞–º–µ—Ä–µ (Linux)

–í `docker-compose.yml` —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–æ—Å—Ç—É–ø –∫ `/dev/video0`:

```yaml
devices:
  - "/dev/video0:/dev/video0"
privileged: true
```

**–í–∞–∂–Ω–æ**: –≠—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –Ω–∞ **Linux**. –ù–∞ macOS —Ñ–∏–∑–∏—á–µ—Å–∫–∏–µ –∫–∞–º–µ—Ä—ã –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã —á–µ—Ä–µ–∑ Docker.

## üì¶ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–µ—Ä–≤–∏—Å–æ–≤

### Frontend (React)

- **–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä**: `destruct-frontend`
- **–ü–æ—Ä—Ç**: 3000
- **Hot reload**: –í–∫–ª—é—á–µ–Ω (–∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ `src/` –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)

### Backend (Node.js + Python)

- **–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä**: `destruct-backend`
- **–ü–æ—Ä—Ç**: 3001
- **Python**: 3.9.6
- **Node.js**: 22.13.1
- **–ú–æ–¥–µ–ª–∏**: YOLO, DeepFace, Whisper

### Nginx

- **–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä**: `destruct-nginx`
- **–ü–æ—Ä—Ç**: 80
- **–†–æ–ª—å**: Reverse proxy –¥–ª—è frontend –∏ backend

## üêõ –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –ü—Ä–æ–±–ª–µ–º–∞: –ü–æ—Ä—Ç—ã –∑–∞–Ω—è—Ç—ã

–ï—Å–ª–∏ –ø–æ—Ä—Ç—ã 80, 3000 –∏–ª–∏ 3001 –∑–∞–Ω—è—Ç—ã:

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–æ—Ä—Ç
lsof -i :80
lsof -i :3000
lsof -i :3001

# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å –∏–ª–∏ –∏–∑–º–µ–Ω–∏—Ç—å –ø–æ—Ä—Ç—ã –≤ docker-compose.yml
```

### –ü—Ä–æ–±–ª–µ–º–∞: –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –Ω–µ –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏
docker compose logs

# –ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å –æ–±—Ä–∞–∑—ã
docker compose down
docker compose up --build
```

### –ü—Ä–æ–±–ª–µ–º–∞: –ú–æ–¥–µ–ª–∏ –Ω–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –º–æ–¥–µ–ª–∏ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤:

```
destruct-server/yolo11/models/
‚îú‚îÄ‚îÄ all.pt
‚îî‚îÄ‚îÄ violence.pt
```

### –ü—Ä–æ–±–ª–µ–º–∞: Hot reload –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ:

- `CHOKIDAR_USEPOLLING=true` —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ docker-compose.yml
- Volumes –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Å–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã
- –§–∞–π–ª—ã –Ω–µ –∏–≥–Ω–æ—Ä–∏—Ä—É—é—Ç—Å—è –≤ `.dockerignore`

## üßπ –û—á–∏—Å—Ç–∫–∞

### –£–¥–∞–ª–∏—Ç—å –≤—Å–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –∏ volumes

```bash
docker compose down -v
```

### –£–¥–∞–ª–∏—Ç—å –æ–±—Ä–∞–∑—ã

```bash
docker compose down --rmi all
```

### –ü–æ–ª–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ (–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã, volumes, –æ–±—Ä–∞–∑—ã, —Å–µ—Ç–∏)

```bash
docker compose down -v --rmi all
```

### –û—á–∏—Å—Ç–∏—Ç—å –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ä–µ—Å—É—Ä—Å—ã Docker

```bash
docker system prune -a
```

## üìù –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

### –í–æ–π—Ç–∏ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä

```bash
# Backend
docker exec -it destruct-backend bash

# Frontend
docker exec -it destruct-frontend sh
```

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤

```bash
docker compose ps
```

### –ü—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤

```bash
docker stats
```
